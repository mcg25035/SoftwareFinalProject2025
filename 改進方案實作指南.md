# FOMO 系統改進方案實作指南

## 一、實作優先順序

根據需求規格對比分析，以下功能需要實作：

### 第一優先級（必須實作）
1. ✅ 商品問答功能
2. ✅ 金流客服與即時協助模組

### 第二優先級（建議實作）
3. ⚠️ 商品追蹤功能
4. ⚠️ 付款方式管理

### 第三優先級（可選實作）
5. ⚠️ 個人化設定

---

## 二、已實作的改進

### ✅ 1. 商品問答功能

**已新增模型**: `ProductQuestion`

**需要實作的功能**:
1. 顧客端視圖：
   - `ask_question` - 提問功能
   - 在商品詳情頁顯示問答列表

2. 管理者端視圖：
   - `answer_question` - 回答問題
   - `question_management` - 問答管理

**下一步**:
```bash
python manage.py makemigrations
python manage.py migrate
```

---

### ✅ 2. 金流客服與即時協助模組

**已新增模型**:
- `CustomerServiceTicket` - 客服工單
- `CustomerServiceMessage` - 客服訊息
- `FAQ` - 常見問題

**需要實作的功能**:
1. 顧客端視圖：
   - `create_ticket` - 建立客服工單
   - `ticket_list` - 工單列表
   - `ticket_detail` - 工單詳情
   - `send_message` - 發送訊息
   - `faq_list` - 常見問題列表

2. 管理者端視圖：
   - `ticket_management` - 工單管理
   - `assign_ticket` - 指派工單
   - `reply_ticket` - 回覆工單
   - `faq_management` - FAQ 管理

**下一步**:
```bash
python manage.py makemigrations
python manage.py migrate
```

---

## 三、待實作功能

### ⚠️ 3. 商品追蹤功能

**需要新增模型**:
```python
class ProductTracking(models.Model):
    """商品追蹤"""
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    product = models.ForeignKey(Product, on_delete=models.CASCADE)
    track_price = models.BooleanField(default=True)
    track_stock = models.BooleanField(default=True)
    track_status = models.BooleanField(default=True)
    created_at = models.DateTimeField(auto_now_add=True)
    
    class Meta:
        unique_together = ['user', 'product']

class ProductPriceHistory(models.Model):
    """商品價格歷史"""
    product = models.ForeignKey(Product, on_delete=models.CASCADE)
    price = models.DecimalField(max_digits=10, decimal_places=2)
    changed_at = models.DateTimeField(auto_now_add=True)
```

**需要實作的功能**:
- `track_product` - 追蹤商品
- `tracked_products` - 追蹤列表
- 價格變動通知
- 庫存變動通知

---

### ⚠️ 4. 付款方式管理

**需要新增模型**:
```python
class PaymentAccount(models.Model):
    """付款帳號"""
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    payment_method = models.ForeignKey(PaymentMethod, on_delete=models.CASCADE)
    account_name = models.CharField(max_length=100)
    account_info = models.JSONField()  # 加密儲存
    is_default = models.BooleanField(default=False)
    is_active = models.BooleanField(default=True)
    created_at = models.DateTimeField(auto_now_add=True)
```

**需要實作的功能**:
- `payment_accounts` - 付款帳號管理
- `add_payment_account` - 新增付款帳號
- `set_default_account` - 設定預設帳號

---

### ⚠️ 5. 個人化設定

**需要擴展現有模型**:
```python
# 擴展 CustomerProfile
preferred_categories = models.ManyToManyField(Category, blank=True)
notification_preferences = models.JSONField(default=dict)
language = models.CharField(max_length=10, default='zh-hant')
theme = models.CharField(max_length=20, default='light')
```

**需要實作的功能**:
- `personalization_settings` - 個人化設定頁面
- `recommend_products` - 個人化商品推薦

---

## 四、實作步驟

### 步驟 1: 執行資料庫遷移

```bash
cd my_final_proj
python manage.py makemigrations
python manage.py migrate
```

### 步驟 2: 實作視圖功能

參考現有的視圖實作模式，新增對應的視圖函數。

### 步驟 3: 建立 URL 路由

在對應的 `urls.py` 中新增路由。

### 步驟 4: 建立模板

建立對應的 HTML 模板檔案。

### 步驟 5: 測試功能

測試所有新增功能是否正常運作。

---

## 五、注意事項

1. **資料加密**: 付款帳號資訊需要加密儲存
2. **權限控制**: 確保客服功能有適當的權限控制
3. **通知系統**: 整合到現有的通知系統
4. **系統日誌**: 記錄所有重要操作

---

**文件版本**: 1.0
**最後更新**: 2025年

